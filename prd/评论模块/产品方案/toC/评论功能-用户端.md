# 博客系统-评论功能需求（用户端）

## 1. 概述

### 1.1 目标

为博客系统用户提供丰富的评论互动功能，使读者能够方便地对文章进行评论、回复和互动，促进用户之间的交流和内容价值提升。

### 1.2 背景

评论功能是博客系统中重要的社交互动组件，它允许用户表达观点、提问和交流，提高用户参与度和访问粘性，同时为作者提供读者反馈。

### 1.3 用户角色

- **访客**：未登录用户，可查看评论但不能发表评论
- **普通用户**：已登录用户，可发表评论和回复
- **文章作者**：发布文章的用户，可管理自己文章下的评论
- **被回复者**：评论被他人回复的用户

## 2. 功能需求

### 2.1 评论发布

#### 2.1.1 发表评论

- **描述**：已登录用户可以对文章发表评论
- **输入字段**：
  - 评论内容（必填，支持纯文本和基础Markdown格式）
  - 附加图片（选填，最多3张）
- **功能流程**：
  1. 用户阅读文章后，在评论区输入评论内容
  2. 可选择添加图片
  3. 点击"发表评论"按钮
  4. 系统验证用户登录状态和评论内容
  5. 评论成功后即时显示在评论列表中
- **限制条件**：
  - 评论内容：10-1000字符
  - 发表频率：同一用户对同一文章2分钟内最多发表3条评论
  - 图片大小：单张不超过2MB

#### 2.1.2 回复评论

- **描述**：用户可以回复他人的评论
- **输入字段**：
  - 回复内容（必填）
  - 附加图片（选填，最多1张）
- **功能流程**：
  1. 用户点击某条评论下的"回复"按钮
  2. 在回复框中输入内容
  3. 点击"发表回复"按钮
  4. 回复成功后即时显示在原评论下方
- **特殊功能**：
  - 支持@用户功能
  - 回复时自动带上被回复者的用户名
- **限制条件**：
  - 回复内容：5-500字符
  - 回复层级：最多支持3层（评论-回复-回复的回复）

### 2.2 评论展示

#### 2.2.1 评论列表

- **描述**：展示文章下的所有评论
- **展示方式**：
  - 默认按时间倒序排列
  - 分页展示，默认每页20条
  - 树形结构显示回复关系
- **每条评论显示内容**：
  - 评论者头像和用户名
  - 评论内容
  - 评论时间
  - 点赞数
  - 回复按钮
  - 举报按钮
  - 该评论的所有回复
- **特殊标识**：
  - 作者评论特殊标识
  - 优质评论标识（高点赞）
  - 被折叠评论提示

#### 2.2.2 评论排序和筛选

- **描述**：用户可以按不同方式排序和筛选评论
- **排序选项**：
  - 最新评论（默认）
  - 最早评论
  - 热门评论（点赞数）
- **筛选选项**：
  - 全部评论
  - 只看作者回复
  - 只看特定用户评论

#### 2.2.3 评论折叠

- **描述**：系统自动折叠部分评论以提升阅读体验
- **折叠规则**：
  - 低质量评论（系统判定或被多人举报）
  - 评论回复超过一定数量时折叠部分回复
  - 评论内容过长时只显示部分
- **用户操作**：
  - 可点击"展开"查看完整内容或所有回复
  - 可设置自己的折叠偏好

### 2.3 评论互动

#### 2.3.1 评论点赞

- **描述**：用户可以对评论进行点赞
- **功能流程**：
  1. 用户点击评论下的"点赞"图标
  2. 系统记录点赞并实时更新点赞数
  3. 点赞图标变为已点赞状态
  4. 再次点击可取消点赞
- **限制条件**：
  - 需要登录
  - 每个用户对同一评论只能点赞一次

#### 2.3.2 评论分享

- **描述**：用户可以分享特定评论
- **分享方式**：
  - 复制评论链接
  - 分享到社交媒体
- **分享内容**：
  - 评论内容
  - 所属文章信息
  - 评论者信息
  - 评论直达链接

#### 2.3.3 评论举报

- **描述**：用户可以举报不当评论
- **举报流程**：
  1. 用户点击评论的"举报"按钮
  2. 选择举报原因（垃圾广告/侮辱谩骂/违法内容/其他）
  3. 可选填举报详情
  4. 提交举报
- **举报后处理**：
  - 系统记录举报信息
  - 达到一定举报阈值自动隐藏
  - 等待管理员审核

### 2.4 个人评论管理

#### 2.4.1 我的评论

- **描述**：用户可以查看和管理自己发表的所有评论
- **功能项**：
  - 查看自己的评论历史
  - 按文章分类查看
  - 查看评论获得的点赞数
  - 查看自己评论收到的回复
- **操作选项**：
  - 编辑自己的评论（发布后5分钟内）
  - 删除自己的评论

#### 2.4.2 评论通知

- **描述**：用户收到与评论相关的通知
- **通知类型**：
  - 评论被回复通知
  - 评论被点赞通知
  - 作者回复通知
  - 评论被引用通知
- **通知方式**：
  - 站内消息
  - 邮件通知（可设置）
  - 实时提醒（网站右上角）

#### 2.4.3 文章作者评论管理

- **描述**：文章作者可以管理自己文章下的评论
- **管理功能**：
  - 置顶重要评论
  - 隐藏不当评论
  - 回复评论时有特殊标识
  - 批量管理评论（导出等）

### 2.5 高级互动功能

#### 2.5.1 评论区投票

- **描述**：文章作者可以在评论区创建投票
- **功能流程**：
  1. 作者创建投票问题和选项
  2. 用户在评论区参与投票
  3. 实时显示投票结果
- **投票类型**：
  - 单选投票
  - 多选投票
  - 评分投票

#### 2.5.2 评论区提问

- **描述**：用户可以在评论区向作者提问
- **特殊标识**：
  - 提问评论有特殊标识
  - 作者回答也有特殊标识
- **功能特点**：
  - 提问可以被顶置
  - 优质提问可以形成文章FAQ

## 3. 用户界面需求

### 3.1 评论输入框

- **界面组成**：
  - 用户头像
  - 文本输入区域
  - Markdown工具栏（基础格式）
  - 图片上传按钮
  - 表情选择器
  - 发布按钮
- **交互特性**：
  - 自动调整高度
  - 实时字数统计
  - 草稿自动保存
  - @用户自动补全

### 3.2 评论列表区

- **界面组成**：
  - 评论统计信息
  - 排序和筛选控件
  - 评论卡片列表
  - 分页控件或加载更多按钮
- **评论卡片设计**：
  - 用户头像靠左
  - 评论内容主体
  - 回复缩进显示
  - 互动按钮（回复/点赞/分享/举报）居右或底部
- **响应式设计**：
  - 桌面端完整展示
  - 移动端精简布局，保留核心功能

### 3.3 个人评论中心

- **界面组成**：
  - 评论统计概览
  - 评论列表（可按文章/时间筛选）
  - 收到的回复列表
  - 评论通知设置
- **数据展示**：
  - 评论总数
  - 获得点赞数
  - 最受欢迎的评论
  - 活跃评论的文章

## 4. 非功能需求

### 4.1 性能需求

- 评论加载时间不超过1秒
- 评论发布响应时间不超过2秒
- 支持单篇文章1万+评论的高效加载
- 高并发评论提交的处理能力

### 4.2 可用性需求

- 评论区操作简单直观
- 移动端优化，支持触摸操作
- 提供清晰的操作反馈
- 网络异常时的评论保存和恢复

### 4.3 安全需求

- 防止XSS攻击，过滤评论中的恶意代码
- 评论频率限制，防止刷评论
- 敏感内容过滤
- 用户隐私保护（可选择匿名评论）

## 5. 用户体验改进点

1. **智能评论排序**
   - 根据用户阅读习惯和兴趣推荐评论
   - 优质评论自动提升排序

2. **评论区亮点提取**
   - 自动提取评论中的精彩观点
   - 在文章底部展示评论亮点

3. **互动游戏化**
   - 评论活跃度积分
   - 优质评论者徽章
   - 评论区等级系统 